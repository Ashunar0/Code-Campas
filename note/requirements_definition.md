# プログラミングスクール教材サイト要件定義書

## 1. システム概要

### 1.1 目的

大学生向けプログラミングスクールの教材を、承認制でオンライン閲覧できる Web サイトを構築する。

### 1.2 技術スタック

- **フロントエンド**: Next.js + React + TypeScript + shadcn/ui
- **バックエンド**: Supabase（認証・データベース・ストレージ）
- **教材同期**: GitHub 連携

## 2. ユーザー種別・権限

### 2.1 管理者（Administrator）

- **権限**:
  - ユーザーの承認・拒否・削除
  - 教材の追加・編集・削除
  - ユーザー一覧の閲覧・管理
  - 学習進捗の確認
  - システム設定の管理

### 2.2 学生（Student）

- **権限**:
  - 教材の閲覧のみ
  - 学習進捗の確認（自分のみ）
- **制限**:
  - 教材のダウンロード不可
  - コメント・質問機能なし

### 2.3 承認待ちユーザー（Pending User）

- **権限**:
  - ログイン可能
  - 承認待ち状態の確認
- **制限**:
  - 教材の閲覧不可

## 3. 機能要件

### 3.1 認証・ユーザー管理機能

### 3.1.1 ユーザー登録

- **必要情報**:
  - 名前（必須）
  - メールアドレス（必須）
  - 参加する期（整数、必須）
- **フロー**:
  1. ユーザーが登録フォームを入力
  2. 仮登録完了メール送信
  3. メール認証後、管理者に承認申請通知
  4. 管理者が承認・拒否を判定
  5. 結果をメールで通知

### 3.1.2 ログイン・ログアウト

- メールアドレス・パスワードによる認証
- パスワードリセット機能

### 3.1.3 ユーザー管理（管理者のみ）

- ユーザー一覧表示（名前、メール、期、ステータス、登録日）
- ユーザーステータス管理
  - 承認待ち（Pending）
  - 承認済み（Approved）
  - 拒否済み（Rejected）
  - 停止（Suspended）
- ユーザーの個別承認・拒否・削除
- 一括承認・拒否機能

### 3.2 教材管理機能

### 3.2.1 GitHub 連携

- **リポジトリ構造**:
  ```
  教材ルート/
  ├── 章1/
  │   ├── 1-1_基礎知識.md
  │   └── 1-2_実践編.md
  ├── 章2/
  │   ├── 2-1_応用編.md
  │   └── 2-2_発展編.md
  └── README.md

  ```
- **自動同期機能**:
  - GitHub Webhook による自動同期
  - マークダウンファイルの変更検知
  - 新規追加・更新・削除の反映
- **同期タイミング**:
  - 手動同期ボタン（管理者用）
- **セキュリティ**:
  - GitHub Personal Access Token（環境変数で管理）
  - Webhook Secret（署名検証）
  - Supabase Edge Functions での処理

### 3.2.2 教材構造

- **階層構造**:
  ```
  教材ルート/
  ├── 章1/
  │   ├── 1-1_基礎知識.md
  │   └── 1-2_実践編.md
  ├── 章2/
  │   ├── 2-1_応用編.md
  │   └── 2-2_発展編.md
  └── README.md

  ```
- **メタデータ**:
  - タイトル
  - 章番号
  - 更新日時
  - タグ・キーワード

### 3.2.3 教材表示

- マークダウンの HTML 変換・表示
- コードハイライト機能
- 目次自動生成
- 前の記事・次の記事ナビゲーション

### 3.3 検索機能

- **検索対象**:
  - 教材タイトル
  - 教材本文
  - タグ・キーワード
- **検索機能**:
  - 全文検索
  - タグフィルタ
  - 章別フィルタ

### 3.4 学習進捗管理機能

### 3.4.1 進捗記録

- **既読判定基準**:
  - 記事最下部に「理解度確認」ボタンを設置
  - ボタンクリックで既読として記録
  - 既読日時を保存
- **進捗データ**:
  - ユーザー ID + 記事 ID + 既読フラグ + 既読日時

### 3.4.2 進捗表示

- **学生向けダッシュボード**:
  - 全体進捗率（%）
  - 章別進捗率
  - 最近読んだ記事
  - 未読記事一覧
- **管理者向けダッシュボード**:
  - 全学生の進捗一覧
  - 期別の進捗統計
  - 記事別の閲覧統計

### 3.5 通知機能

- **メール通知**:
  - 送信方法：専用 Gmail アカウント（SMTP 経由）
  - 通知内容：
    - 仮登録完了通知
    - 承認・拒否結果通知
    - 新教材追加通知（オプション）
  - テンプレート：シンプルでプロフェッショナルなデザイン

## 4. 非機能要件

### 4.1 性能要件

- **想定ユーザー数**: 100-200 人
- **同時接続数**: 50 人程度
- **レスポンス時間**: 3 秒以内
- **教材更新頻度**: 半年に 1 回程度

### 4.2 セキュリティ要件

- HTTPS 通信の強制
- SQL インジェクション対策
- XSS 対策
- CSRF 対策
- 認証情報の暗号化

### 4.3 可用性要件

- **稼働率**: 99%以上（メンテナンス時間除く）
- **バックアップ**: 日次自動バックアップ

## 5. データベース設計概要

### 5.1 主要テーブル

- **users**: ユーザー情報
- **materials**: 教材情報
- **chapters**: 章情報
- **reading_progress**: 学習進捗
- **admin_logs**: 管理ログ

### 5.2 主要カラム例

```sql
-- users テーブル
users (
  id: uuid,
  email: string,
  name: string,
  period: integer,
  status: enum('pending', 'approved', 'rejected', 'suspended'),
  created_at: timestamp,
  approved_at: timestamp
)

-- materials テーブル
materials (
  id: uuid,
  title: string,
  slug: string,
  content: text,
  chapter_id: uuid,
  github_path: string,
  order_index: integer,
  created_at: timestamp,
  updated_at: timestamp
)

-- reading_progress テーブル
reading_progress (
  id: uuid,
  user_id: uuid,
  material_id: uuid,
  is_read: boolean,
  read_at: timestamp
)

```

## 6. 画面構成

### 6.1 共通画面

- ログイン画面
- ユーザー登録画面
- パスワードリセット画面

### 6.2 学生向け画面

- ダッシュボード（進捗確認）
- 教材一覧画面
- 教材詳細画面
- 検索結果画面

### 6.3 管理者向け画面

- 管理者ダッシュボード
- ユーザー管理画面
- 教材管理画面
- システム設定画面

## 7. 開発フェーズ

### Phase 1: 基盤機能

- 認証システム
- ユーザー管理
- 基本的な教材表示

### Phase 2: 教材機能

- GitHub 連携
- 検索機能
- 教材管理機能

### Phase 3: 進捗管理

- 学習進捗機能
- ダッシュボード
- 統計機能

### Phase 4: 運用機能

- 通知機能
- ログ機能
- 最適化

## 8. 運用・保守

### 8.1 定期メンテナンス

- データベースバックアップ確認
- ログファイルのローテーション
- セキュリティアップデート

### 8.2 監視項目

- システム稼働状況
- エラーログ
- アクセス状況
- GitHub 同期状況

## 10. UI/UX ガイドライン

### 10.1 デザインシステム

- **スタイル**: モダン、クリーン、shadcn/ui 準拠
- **メインカラー**: #b23a60
- **カラーパレット**:
  - Primary: #b23a60
  - Secondary: 自動生成（#b23a60 のコンプリメンタリー）
  - Background: white/gray-50
  - Text: gray-900/gray-600

### 10.2 コンポーネント

- shadcn/ui コンポーネントを基本とする
- カスタムカラーテーマの適用
- 一貫したスペーシング・タイポグラフィ

## 11. 今後の拡張可能性

### 11.1 機能拡張案

- 学習時間の記録
- 習熟度テスト機能
- 学習レポート機能
- モバイルアプリ対応

### 11.2 技術的拡張

- CDN 導入
- 画像・動画コンテンツ対応
- オフライン閲覧機能
